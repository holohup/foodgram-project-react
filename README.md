![API YamDB workflow](https://github.com/holohup/foodgram-project-react/actions/workflows/foodgram.yml/badge.svg)
[![Django](https://img.shields.io/badge/-Django-464646?style=flat-square&logo=Django)](https://www.djangoproject.com/)
[![Django REST Framework](https://img.shields.io/badge/-Django%20REST%20Framework-464646?style=flat-square&logo=Django%20REST%20Framework)](https://www.django-rest-framework.org/)
[![Python 3.7](https://img.shields.io/badge/python-3.7-blue.svg)](https://www.python.org/downloads/release/python-370/)
[![PostgreSQL](https://img.shields.io/badge/-PostgreSQL-464646?style=flat-square&logo=PostgreSQL)](https://www.postgresql.org/)
[![Nginx](https://img.shields.io/badge/-NGINX-464646?style=flat-square&logo=NGINX)](https://nginx.org/ru/)
[![docker](https://img.shields.io/badge/-Docker-464646?style=flat-square&logo=docker)](https://www.docker.com/)
[![GitHub%20Actions](https://img.shields.io/badge/-GitHub%20Actions-464646?style=flat-square&logo=GitHub%20actions)](https://github.com/features/actions)

# Дипломный проект - бэкэнд для Foodgram

## Постановка задачи

К имеющемуся фронтэнду нужно написать бэкэнд по подробной спецификации на нужные эндпоинты и описанию проекта. Проект представляет из себя удобный сервис для любителей готовить. На сайт можно добавлять рецепты, ставить к ним тэги, добавлять в избранное, подписываться на любимых авторов, а также добавлять рецепты в списки покупок - сайт автоматически считает, сколько и чего нужно купить и позволяет скачать эту информацию одним файлом. 

### Язык проекта

Проект будет драгоценным камнем в короне моих работ на гитхабе, которые собрались к окончанию курса на Yandex.practicum, поэтому, как и остальные проекты для портфолио, он пишется на английском языке. Для публично-доступной версии будут убраны ссылки на redoc, ингридиенты, любезно предоставленные Яндексом и пр. конфиденциальные данные, будет переведен без купюр и этот текст.

## Технологии

Проект протестирован на Python 3.7, но автор не видит причин, по которым он не должен работать на более поздних версиях в рамках 3 ветки.

## Установка и запуск проекта

Существует три уровня знакомства с проектом:

### Посмотреть, как работает

Просто зайдите на сайт http://ondeletecascade.ru . На сайте уже загружены рецепты, можно понажимать на кнопки, скачать список покупок и вообще, воспользоваться доступным функционалом.

### Запустить на своем компьютере при помощи docker-compose

#### Скачиваем и запускаем проект:

```
git clone https://github.com/holohup/foodgram-project-react.git && cd foodgram-project-react/infra && cp .env.sample .env && docker-compose up -d --remove-orphans
```
Обратите внимание: в файле _.env.sample_ лежат тестовые настройки, необходимые для запуска проекта в режиме "посмотреть как работает". Если хочется чего-то большего, отредактируйте их под себя, названия переменных вполне понятные. Если Вы хотите запустить проект на сервере, или вообще любом компьютере, отличным от Вашего текущего, убедитесь, что Вы раскомментировали последнюю строчку этого файла в внесли туда ip-адрес или имя хоста.

#### Собираем статику, делаем миграции:

```
docker-compose exec -it backend python manage.py collectstatic --noinput && docker-compose exec -it backend python manage.py migrate
```
После успешного запуска, можно ознакомиться с подробной спецификацией на эндпоинты адресу http://localhost/api/docs/

Пока что проект пустой и смотреть особо нечего. Для удобства ознакомления к проекту прилагается файл с готовыми данными - рецептами, пользователями и т.д. Загрузите его:
```
docker-compose exec -it backend fixtures/presets.sh
```
**!NB** Загружать пресеты нужно до того, как Вы выполнили какие-либо операции с базой - зарегистрировали пользователя, создали рецепт и т.д. Если Вы уже успели что-то сделать на проекте, операцию провернуть не удастся, в таком случае лучше всего будет провести процесс установки заново, очистив компьютер от имеющихся томов, в которых остались старые данные.

Теперь можно:
- Зайти в качестве администратора по адресу: http://localhost/admin/ с реквизитами **admin@ngs.ru** / **admin** и посмотреть, как там все устроено.
- Полистать рецепты и зарегистрироваться: http://localhost/

Помимо администратора в базе появится еще один пользователь, не имеющий административных привелегий: **pepin@kqed.com** / **pepinpepinpepin**. Можно пользоваться его реквизитами для того, чтобы тестировать сайт, создавать рецепты, и т.д.


### Сделать все своими руками (самый трудный и почетный путь)

Необходимо склонировать репозиторий:
```
git clone https://github.com/holohup/foodgram-project-react.git
```
После чего, пройти по стандартным шагам:
- Создать виртуальное окружение
- Установить зависимости из requirements.txt
- Поднять базу данных postgresql, проект работает с ней
- Настроить проект под свои задачи в settings.py. 

После чего, сделать:
```bash
python manage.py runserver
```
Это будет чистый бэкенд, без nginx и фронта, можно редактировать код и проверять, как работают запросы. Это самый близкий способ знакомства с проектом.

## Тестирование

Если Вы планируете вносить изменения в проекте, рекомендуется тестировать их прежде, чем они попадут в репозиторий. Для эндпоинтов, основных моделей и функций проекта написаны тесты. Чтобы их запустить, в виртуальном окружении проекта из папки _backend_, или в контейнере backend выполните команду:
```
python manage.py test
```
Чтобы исполнить ее в докере:
```
docker-compose exec -it backend python manage.py test
```
Также рекомендуется настроить Ваш github action проекта так, чтобы эти тесты автоматически запускались перед деплоем, это позволит избежать многих досадных недоразумений.